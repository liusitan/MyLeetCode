Brick falling is the variant of the union_find, the key idea is to apply union find reversely. think about a simple example ooooo, and 02010. what the effect of each opeartion brings to the bricks. THe first operation cut the connection between o1 o2 and o3 o4. and the second operation cut the connection between the o1 and the rests. The number of bricks that is fallen after operation 2 is the remaing bricks after operation 1 - remaining bricks after the operation 2. The way to calculate the remaing bricks to calculate the number of blocks sthat is connected to the "0", theoretically, we can calculate it for every fallen bricks. But it can be further optimized by recovery idea. thus we make a 
r(h1,h2,h3) = r(h1,h2) - fallen
then we have ds(h1,h2)[0] = ds[h1,h2,h3] union recovered h3 